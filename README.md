# NetworksLab2021
# Описание протокола

Заголовок в 8 бит

- В сообщении от клиента к серверу передается сначала длина сообщения а затем и сообщение как временная зона, имя и сообщение в формате 
<tz>name->message либо клучевое слово file после которого требуется ввести имя файла. tz представленна строкой, например 
'Europe/Moscow'. Файл передается как заголовок длины, потом имя файла и его размер а потом сам файла как поток байт.

- От сервера к клиенту даннуе пересылаются аналогично, для передачи файла принимается ключевое слово file после чего
вся переданная от пользователя информация записывается в переменные и транслируется ко всем подключенным. При передачи 
простого сообщения из принятого потока достается временная зона и время на сервере записывается в транслирующее всем 
пользователям сообщение измененным в соотствии с временной зоной пользователя.

# Основные классы и функции
Классов нет
В серевере 3 функции: handle, broadcast и receive_connection.

- broadcast просто трансирует сообщение пользователям
- handle обрабатывает все полученные данные
- receive_connection принимает соединение от пользователя

В клиенте 2 функции: receive_message и send_message.

- receive_message принимает сообщение от сервера
- send_message отправляет сообщение на сервер

# Описние проблем с которыми столкнулся

Самой большой была проблема принять полностью длинное сообщение. В итоге я смог реализовать 2 варианта решения этой проблемы:
1) Это тот который реализован сейчас с использованием заголовка
2) Использование разделителей. От него я отказался так как почему-то, при использовании кодировки utf-8, utf-16 и utf-32
русский текст, который выходил за размер буфера (а он был фиксирован и равен 1024) всегда выдавал ошибку декодирования 
при приеме, соответственно если буфер вмещал сообщение полностью то и ошибки не было

Как таковой проблемы с часовыми поясами у меня не было, я достаточно быстро нашел библиотеку pytz на которую была ссылка
чуть ли не в каждом вопросе работы с tz на stackoverflow.

С файлами также проблем серьезных не возникло, так как с ними работа по большей части такая же как и с 
пересылкой больших сообщений, разве что мысль о том, что данные файла можно записать в переменную вместо того, чтобы создавать его 
на сервере, отправлять и после этого удалять с сервера это принадлежит не мне а была подсказана напрямую преподавателем. .
